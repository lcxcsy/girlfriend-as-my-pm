{"version":3,"sources":["webpack:///./src/pages/Admin.vue?f23d","webpack:///src/pages/Admin.vue","webpack:///./src/pages/Admin.vue?6e30","webpack:///./src/pages/Admin.vue","webpack:///./src/pages/Admin.vue?8696"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","active","_l","item","index","key","attrs","computeTotalDay","startTime","endTime","scopedSlots","_u","fn","areaName","staticStyle","reason","status","proxy","isAdmin","_e","on","$event","handleDeal","recordId","queryTripRecord","model","value","callback","$$v","expression","staticRenderFns","name","data","appKey","recordList","computed","APP_KEY","created","$route","query","sessionStorage","getItem","methods","Date","component"],"mappings":"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","file":"static/js/chunk-38a23850.3d07c8ef.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"record-wrapper\"},[_c('div',{staticClass:\"person-name\"},[_vm._v(_vm._s(_vm.active ? '请您审批~' : '审批完成^_^'))]),_c('div',{staticClass:\"card-wrapper\"},_vm._l((_vm.recordList),function(item,index){return _c('van-card',{key:index,attrs:{\"title\":(\"申请人：\" + (item.personName)),\"desc\":(\"出差时间：\" + (item.startTime) + \" ~ \" + (item.endTime) + \" 共\" + (_vm.computeTotalDay(item.startTime,item.endTime)) + \"天\")},scopedSlots:_vm._u([{key:\"tags\",fn:function(){return [_c('div',[_vm._v(\" 出差地点：\"+_vm._s(item.areaName)+\" \")]),_c('div',{staticStyle:{\"width\":\"100%\"}},[_vm._v(\" 出差事由：\"+_vm._s(item.reason)+\" \")]),_c('van-tag',{staticStyle:{\"position\":\"absolute\",\"right\":\"0\",\"top\":\"0\"},attrs:{\"type\":item.status === 3 ? 'success' : item.status === 2 ? 'danger' : 'warning'}},[_vm._v(_vm._s(item.status === 3 ? '审批通过' : item.status === 2 ? '已拒绝' : '未审批'))])]},proxy:true},{key:\"footer\",fn:function(){return [(_vm.isAdmin && (item.status === 1 || !item.status))?_c('van-button',{staticStyle:{\"position\":\"absolute\",\"left\":\"10px\"},attrs:{\"size\":\"small\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.handleDeal(2, item.recordId)}}},[_vm._v(\"拒绝\")]):_vm._e(),(_vm.isAdmin && (item.status === 1 || !item.status))?_c('van-button',{attrs:{\"size\":\"small \",\"type\":\"primary\"},on:{\"click\":function($event){return _vm.handleDeal(3, item.recordId)}}},[_vm._v(\"通过\")]):_vm._e()]},proxy:true}],null,true)})}),1),_c('van-tabbar',{on:{\"change\":_vm.queryTripRecord},model:{value:(_vm.active),callback:function ($$v) {_vm.active=$$v},expression:\"active\"}},[_c('van-tabbar-item',{attrs:{\"icon\":\"good-job-o\"}},[_vm._v(\"已审批\")]),_c('van-tabbar-item',{attrs:{\"icon\":\"records\"}},[_vm._v(\"未审批\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"record-wrapper\">\r\n    <div class=\"person-name\">{{ active ? '请您审批~' : '审批完成^_^' }}</div>\r\n    <div class=\"card-wrapper\">\r\n      <van-card\r\n        v-for=\"(item, index) in recordList\"\r\n        :key=\"index\"\r\n        :title=\"`申请人：${item.personName}`\"\r\n        :desc=\"`出差时间：${item.startTime} ~ ${item.endTime} 共${computeTotalDay(item.startTime,item.endTime)}天`\"\r\n      >\r\n        <template #tags>\r\n          <div>\r\n            出差地点：{{item.areaName}}\r\n          </div>\r\n          <div style=\"width: 100%\">\r\n            出差事由：{{item.reason}}\r\n          </div>\r\n          <van-tag\r\n            :type=\"item.status === 3 ? 'success' : item.status === 2 ? 'danger' : 'warning'\"\r\n            style=\"position: absolute; right: 0; top: 0;\"\r\n          >{{item.status === 3 ? '审批通过' : item.status === 2 ? '已拒绝' : '未审批'}}</van-tag>\r\n        </template>\r\n        <template #footer>\r\n          <van-button\r\n            v-if=\"isAdmin && (item.status === 1 || !item.status)\"\r\n            size=\"small\"\r\n            type=\"danger\"\r\n            style=\"position: absolute; left: 10px;\"\r\n            @click=\"handleDeal(2, item.recordId)\"\r\n          >拒绝</van-button>\r\n          <van-button\r\n            v-if=\"isAdmin && (item.status === 1 || !item.status)\"\r\n            size=\"small \"\r\n            type=\"primary\"\r\n            @click=\"handleDeal(3, item.recordId)\"\r\n          >通过</van-button>\r\n        </template>\r\n      </van-card>\r\n    </div>\r\n    <van-tabbar\r\n      v-model=\"active\"\r\n      @change=\"queryTripRecord\"\r\n    >\r\n      <van-tabbar-item icon=\"good-job-o\">已审批</van-tabbar-item>\r\n      <van-tabbar-item icon=\"records\">未审批</van-tabbar-item>\r\n    </van-tabbar>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { Dialog } from 'vant'\r\nimport { queryTripRecord, updateTripRecord } from '@/api/index'\r\nconst APP_KEY = 'Ul0jhI3RRDvWkINjSckhtw=='\r\n\r\nexport default {\r\n  name: 'Record',\r\n  data () {\r\n    return {\r\n      appKey: '',\r\n      active: 0,\r\n      recordList: []\r\n    }\r\n  },\r\n  computed: {\r\n    isAdmin () {\r\n      return this.appKey === APP_KEY\r\n    }\r\n  },\r\n  created () {\r\n    this.appKey = this.$route.query.appKey || sessionStorage.getItem('appKey') || ''\r\n\r\n    if (this.appKey) {\r\n      this.queryTripRecord()\r\n    } else {\r\n      Dialog.alert({ message: '您暂无权限！' })\r\n    }\r\n  },\r\n  methods: {\r\n    async queryTripRecord () {\r\n      try {\r\n        const { data } = await queryTripRecord({\r\n          greatLifeKey: this.greatLifeKey,\r\n          status: this.active ? [1] : [2, 3],\r\n          isAdmin: this.isAdmin\r\n        })\r\n        this.recordList = data\r\n      } catch (err) {\r\n        console.log('queryTripRecord', err)\r\n      }\r\n    },\r\n\r\n    computeTotalDay (startTime, endTime) {\r\n      return (new Date(endTime) - new Date(startTime)) / (1000 * 60 * 60 * 24) + 1\r\n    },\r\n\r\n    // 处理审批\r\n    async handleDeal (status, recordId) {\r\n      try {\r\n        await updateTripRecord({ status, recordId })\r\n        Dialog.alert({\r\n          message: '您已成功处理该条出差申请！'\r\n        })\r\n        this.queryTripRecord()\r\n      } catch (err) {\r\n        console.log('updateTripRecord', err)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.record-wrapper {\r\n  height: 100vh;\r\n  padding: 140px 12px 60px 12px;\r\n  background-image: url('~@/assets/bg.jpg');\r\n  background-repeat: no-repeat;\r\n  background-size: 100% 100%;\r\n  .person-name {\r\n    margin-left: 12px;\r\n    margin-bottom: 12px;\r\n    font-size: 24px;\r\n    font-weight: bold;\r\n  }\r\n  .card-wrapper {\r\n    width: 100%;\r\n    height: calc(100vh - 183px);\r\n    padding-bottom: 60px;\r\n    overflow: scroll;\r\n  }\r\n  ::v-deep .van-card__desc {\r\n    color: #323233;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Admin.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Admin.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Admin.vue?vue&type=template&id=456ce7fc&scoped=true&\"\nimport script from \"./Admin.vue?vue&type=script&lang=js&\"\nexport * from \"./Admin.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Admin.vue?vue&type=style&index=0&id=456ce7fc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"456ce7fc\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Admin.vue?vue&type=style&index=0&id=456ce7fc&lang=scss&scoped=true&\""],"sourceRoot":""}